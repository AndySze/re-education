/*!
 * jQuery Form Plugin
 * version: 2.80 (25-MAY-2011)
 * @requires jQuery v1.3.2 or later
 *
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */
(function(e){function t(){var e="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(e):window.opera&&window.opera.postError&&window.opera.postError(e)}e.fn.ajaxSubmit=function(n){function g(r){function g(){var t=c.attr("target"),n=c.attr("action");i.setAttribute("target",a),i.getAttribute("method")!="POST"&&i.setAttribute("method","POST"),i.getAttribute("action")!=o.url&&i.setAttribute("action",o.url),o.skipEncodingOverride||c.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),o.timeout&&(m=setTimeout(function(){v=!0,S(!0)},o.timeout));var r=[];try{if(o.extraData)for(var s in o.extraData)r.push(e('<input type="hidden" name="'+s+'" value="'+o.extraData[s]+'" />').appendTo(i)[0]);o.iframeTarget||(f.appendTo("body"),l.attachEvent?l.attachEvent("onload",S):l.addEventListener("load",S,!1)),i.submit()}finally{i.setAttribute("action",n),t?i.setAttribute("target",t):c.removeAttr("target"),e(r).remove()}}function S(n){if(h.aborted||E)return;if(n===!0&&h){h.abort("timeout");return}var r=l.contentWindow?l.contentWindow.document:l.contentDocument?l.contentDocument:l.document;if(!r||r.location.href==o.iframeSrc)if(!v)return;l.detachEvent?l.detachEvent("onload",S):l.removeEventListener("load",S,!1);var i="success",s;try{if(v)throw"timeout";var a=o.dataType=="xml"||r.XMLDocument||e.isXMLDoc(r);t("isXml="+a);if(!a&&window.opera&&(r.body==null||r.body.innerHTML=="")&&--w){t("requeing onLoad callback, DOM not available"),setTimeout(S,250);return}var c=r.body?r.body:r.documentElement;h.responseText=c?c.innerHTML:null,h.responseXML=r.XMLDocument?r.XMLDocument:r,a&&(o.dataType="xml"),h.getResponseHeader=function(e){var t={"content-type":o.dataType};return t[e]},c&&(h.status=Number(c.getAttribute("status"))||h.status,h.statusText=c.getAttribute("statusText")||h.statusText);var p=o.dataType||"",d=/(json|script|text)/.test(p.toLowerCase());if(d||o.textarea){var g=r.getElementsByTagName("textarea")[0];if(g)h.responseText=g.value,h.status=Number(g.getAttribute("status"))||h.status,h.statusText=g.getAttribute("statusText")||h.statusText;else if(d){var b=r.getElementsByTagName("pre")[0],T=r.getElementsByTagName("body")[0];b?h.responseText=b.textContent?b.textContent:b.innerHTML:T&&(h.responseText=T.innerHTML)}}else o.dataType=="xml"&&!h.responseXML&&h.responseText!=null&&(h.responseXML=x(h.responseText));try{y=N(h,o.dataType,o)}catch(n){i="parsererror",h.error=s=n||i}}catch(n){t("error caught",n),i="error",h.error=s=n||i}h.aborted&&(t("upload aborted"),i=null),h.status&&(i=h.status>=200&&h.status<300||h.status===304?"success":"error"),i==="success"?(o.success&&o.success.call(o.context,y,"success",h),u&&e.event.trigger("ajaxSuccess",[h,o])):i&&(s==undefined&&(s=h.statusText),o.error&&o.error.call(o.context,h,i,s),u&&e.event.trigger("ajaxError",[h,o,s])),u&&e.event.trigger("ajaxComplete",[h,o]),u&&!--e.active&&e.event.trigger("ajaxStop"),o.complete&&o.complete.call(o.context,h,i),E=!0,o.timeout&&clearTimeout(m),setTimeout(function(){o.iframeTarget||f.remove(),h.responseXML=null},100)}var i=c[0],s,o,u,a,f,l,h,p,d,v,m;if(r)for(s=0;s<r.length;s++)e(i[r[s].name]).attr("disabled",!1);if(e(":input[name=submit],:input[id=submit]",i).length){alert('Error: Form elements must not have name or id of "submit".');return}o=e.extend(!0,{},e.ajaxSettings,n),o.context=o.context||o,a="jqFormIO"+(new Date).getTime(),o.iframeTarget?(f=e(o.iframeTarget),d=f.attr("name"),d==null?f.attr("name",a):a=d):(f=e('<iframe name="'+a+'" src="'+o.iframeSrc+'" />'),f.css({position:"absolute",top:"-1000px",left:"-1000px"})),l=f[0],h={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(n){var r=n==="timeout"?"timeout":"aborted";t("aborting upload... "+r),this.aborted=1,f.attr("src",o.iframeSrc),h.error=r,o.error&&o.error.call(o.context,h,r,r),u&&e.event.trigger("ajaxError",[h,o,r]),o.complete&&o.complete.call(o.context,h,r)}},u=o.global,u&&!(e.active++)&&e.event.trigger("ajaxStart"),u&&e.event.trigger("ajaxSend",[h,o]);if(o.beforeSend&&o.beforeSend.call(o.context,h,o)===!1){o.global&&e.active--;return}if(h.aborted)return;p=i.clk,p&&(d=p.name,d&&!p.disabled&&(o.extraData=o.extraData||{},o.extraData[d]=p.value,p.type=="image"&&(o.extraData[d+".x"]=i.clk_x,o.extraData[d+".y"]=i.clk_y))),o.forceSync?g():setTimeout(g,10);var y,b,w=50,E,x=e.parseXML||function(e,t){return window.ActiveXObject?(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml"),t&&t.documentElement&&t.documentElement.nodeName!="parsererror"?t:null},T=e.parseJSON||function(e){return window.eval("("+e+")")},N=function(t,n,r){var i=t.getResponseHeader("content-type")||"",s=n==="xml"||!n&&i.indexOf("xml")>=0,o=s?t.responseXML:t.responseText;return s&&o.documentElement.nodeName==="parsererror"&&e.error&&e.error("parsererror"),r&&r.dataFilter&&(o=r.dataFilter(o,n)),typeof o=="string"&&(n==="json"||!n&&i.indexOf("json")>=0?o=T(o):(n==="script"||!n&&i.indexOf("javascript")>=0)&&e.globalEval(o)),o}}if(!this.length)return t("ajaxSubmit: skipping submit process - no element selected"),this;typeof n=="function"&&(n={success:n});var r=this.attr("action"),i=typeof r=="string"?e.trim(r):"";i=i||window.location.href||"",i&&(i=(i.match(/^([^#]+)/)||[])[1]),n=e.extend(!0,{url:i,success:e.ajaxSettings.success,type:this[0].getAttribute("method")||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},n);var s={};this.trigger("form-pre-serialize",[this,n,s]);if(s.veto)return t("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(n.beforeSerialize&&n.beforeSerialize(this,n)===!1)return t("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var o,u,a=this.formToArray(n.semantic);if(n.data){n.extraData=n.data;for(o in n.data)if(n.data[o]instanceof Array)for(var f in n.data[o])a.push({name:o,value:n.data[o][f]});else u=n.data[o],u=e.isFunction(u)?u():u,a.push({name:o,value:u})}if(n.beforeSubmit&&n.beforeSubmit(a,this,n)===!1)return t("ajaxSubmit: submit aborted via beforeSubmit callback"),this;this.trigger("form-submit-validate",[a,this,n,s]);if(s.veto)return t("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var l=e.param(a);n.type.toUpperCase()=="GET"?(n.url+=(n.url.indexOf("?")>=0?"&":"?")+l,n.data=null):n.data=l;var c=this,h=[];n.resetForm&&h.push(function(){c.resetForm()}),n.clearForm&&h.push(function(){c.clearForm()});if(!n.dataType&&n.target){var p=n.success||function(){};h.push(function(t){var r=n.replaceTarget?"replaceWith":"html";e(n.target)[r](t).each(p,arguments)})}else n.success&&h.push(n.success);n.success=function(e,t,r){var i=n.context||n;for(var s=0,o=h.length;s<o;s++)h[s].apply(i,[e,t,r||c,c])};var d=e("input:file",this).length>0,v="multipart/form-data",m=c.attr("enctype")==v||c.attr("encoding")==v;return n.iframe!==!1&&(d||n.iframe||m)?n.closeKeepAlive?e.get(n.closeKeepAlive,function(){g(a)}):g(a):e.ajax(n),this.trigger("form-submit-notify",[this,n]),this},e.fn.ajaxForm=function(n){if(this.length===0){var r={s:this.selector,c:this.context};return!e.isReady&&r.s?(t("DOM not ready, queuing ajaxForm"),e(function(){e(r.s,r.c).ajaxForm(n)}),this):(t("terminating; zero elements found by selector"+(e.isReady?"":" (DOM not ready)")),this)}return this.ajaxFormUnbind().bind("submit.form-plugin",function(t){t.isDefaultPrevented()||(t.preventDefault(),e(this).ajaxSubmit(n))}).bind("click.form-plugin",function(t){var n=t.target,r=e(n);if(!r.is(":submit,input:image")){var i=r.closest(":submit");if(i.length==0)return;n=i[0]}var s=this;s.clk=n;if(n.type=="image")if(t.offsetX!=undefined)s.clk_x=t.offsetX,s.clk_y=t.offsetY;else if(typeof e.fn.offset=="function"){var o=r.offset();s.clk_x=t.pageX-o.left,s.clk_y=t.pageY-o.top}else s.clk_x=t.pageX-n.offsetLeft,s.clk_y=t.pageY-n.offsetTop;setTimeout(function(){s.clk=s.clk_x=s.clk_y=null},100)})},e.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},e.fn.formToArray=function(t){var n=[];if(this.length===0)return n;var r=this[0],i=t?r.getElementsByTagName("*"):r.elements;if(!i)return n;var s,o,u,a,f,l,c;for(s=0,l=i.length;s<l;s++){f=i[s],u=f.name;if(!u)continue;if(t&&r.clk&&f.type=="image"){!f.disabled&&r.clk==f&&(n.push({name:u,value:e(f).val()}),n.push({name:u+".x",value:r.clk_x},{name:u+".y",value:r.clk_y}));continue}a=e.fieldValue(f,!0);if(a&&a.constructor==Array)for(o=0,c=a.length;o<c;o++)n.push({name:u,value:a[o]});else a!==null&&typeof a!="undefined"&&n.push({name:u,value:a})}if(!t&&r.clk){var h=e(r.clk),p=h[0];u=p.name,u&&!p.disabled&&p.type=="image"&&(n.push({name:u,value:h.val()}),n.push({name:u+".x",value:r.clk_x},{name:u+".y",value:r.clk_y}))}return n},e.fn.formSerialize=function(t){return e.param(this.formToArray(t))},e.fn.fieldSerialize=function(t){var n=[];return this.each(function(){var r=this.name;if(!r)return;var i=e.fieldValue(this,t);if(i&&i.constructor==Array)for(var s=0,o=i.length;s<o;s++)n.push({name:r,value:i[s]});else i!==null&&typeof i!="undefined"&&n.push({name:this.name,value:i})}),e.param(n)},e.fn.fieldValue=function(t){for(var n=[],r=0,i=this.length;r<i;r++){var s=this[r],o=e.fieldValue(s,t);if(o===null||typeof o=="undefined"||o.constructor==Array&&!o.length)continue;o.constructor==Array?e.merge(n,o):n.push(o)}return n},e.fieldValue=function(t,n){var r=t.name,i=t.type,s=t.tagName.toLowerCase();n===undefined&&(n=!0);if(n&&(!r||t.disabled||i=="reset"||i=="button"||(i=="checkbox"||i=="radio")&&!t.checked||(i=="submit"||i=="image")&&t.form&&t.form.clk!=t||s=="select"&&t.selectedIndex==-1))return null;if(s=="select"){var o=t.selectedIndex;if(o<0)return null;var u=[],a=t.options,f=i=="select-one",l=f?o+1:a.length;for(var c=f?o:0;c<l;c++){var h=a[c];if(h.selected){var p=h.value;p||(p=h.attributes&&h.attributes.value&&!h.attributes.value.specified?h.text:h.value);if(f)return p;u.push(p)}}return u}return e(t).val()},e.fn.clearForm=function(){return this.each(function(){e("input,select,textarea",this).clearFields()})},e.fn.clearFields=e.fn.clearInputs=function(){return this.each(function(){var e=this.type,t=this.tagName.toLowerCase();e=="text"||e=="password"||t=="textarea"?this.value="":e=="checkbox"||e=="radio"?this.checked=!1:t=="select"&&(this.selectedIndex=-1)})},e.fn.resetForm=function(){return this.each(function(){(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType)&&this.reset()})},e.fn.enable=function(e){return e===undefined&&(e=!0),this.each(function(){this.disabled=!e})},e.fn.selected=function(t){return t===undefined&&(t=!0),this.each(function(){var n=this.type;if(n=="checkbox"||n=="radio")this.checked=t;else if(this.tagName.toLowerCase()=="option"){var r=e(this).parent("select");t&&r[0]&&r[0].type=="select-one"&&r.find("option").selected(!1),this.selected=t}})}})(jQuery);